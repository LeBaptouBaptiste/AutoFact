<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="DBAutofact.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="1"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="1515"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="0"/><expanded_item id="12" parent="0"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="Particuliers" custom_title="0" dock_id="2" table="4,12:mainParticuliers"/><dock_state state="000000ff00000000fd00000001000000020000023d00000217fc0100000002fb000000160064006f0063006b00420072006f00770073006500310100000000ffffffff0000000000000000fb000000160064006f0063006b00420072006f007700730065003201000000000000023d0000012300ffffff0000023d0000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Avoirs" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="3" mode="0"/></sort><column_widths><column index="1" value="35"/><column index="2" value="57"/><column index="3" value="51"/><column index="4" value="40"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Clients" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="231"/><column index="3" value="47"/><column index="4" value="167"/><column index="5" value="48"/><column index="6" value="184"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Clients_Old" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="239"/><column index="3" value="47"/><column index="4" value="143"/><column index="5" value="207"/><column index="6" value="111"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="CodesPromo" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="35"/><column index="3" value="62"/><column index="4" value="42"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Contrats" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="63"/><column index="2" value="35"/><column index="3" value="40"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="DelaisPaiement" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="159"/><column index="3" value="51"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Designations" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="159"/><column index="3" value="55"/><column index="4" value="300"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="EtatsContrat" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="63"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Particuliers" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="52"/><column index="3" value="95"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Produits" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="63"/><column index="3" value="57"/><column index="4" value="90"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Services" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="41"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="ServicesClients" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="64"/><column index="3" value="56"/><column index="4" value="55"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Societes" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="143"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="StatutsContrats" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="64"/><column index="2" value="35"/><column index="3" value="87"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="TypesReduc" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="35"/><column index="2" value="41"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1*">SELECT Clients.id, Clients.nom, Particuliers.prenom, SUM(ServicesClients.quantité * ServicesClients.prix) AS total
FROM Contrats
INNER JOIN Clients ON Clients.id = Contrats.client
INNER JOIN Particuliers ON Particuliers.id = Clients.id
INNER JOIN StatutsContrats ON StatutsContrats.reference = Contrats.reference
INNER JOIN ServicesClients ON ServicesClients.reference = Contrats.reference
WHERE (StatutsContrats.dateAction BETWEEN '2024-01-01' AND '2025-01-01') AND StatutsContrats.etat = 5
GROUP BY Clients.id
ORDER BY total DESC;

INSERT INTO Contrats(reference, id, client) VALUES('C005', 1, 4);
INSERT INTO StatutsContrats(reference, etat, dateAction) VALUES('C005', 5, '2024-09-18');
INSERT INTO ServicesClients(id, reference, quantité, prix) VALUES(4, 'C005', 4, 29.99); 
</sql><sql name="SQL 2*">-- Ajout de nouveaux clients
INSERT INTO Clients (id, adresse, cp, tel, mail, nom) VALUES
(9, '10 Rue du Mont', '75005', '0601010203', 'paul.mont@example.com', 'Paul Mont'),
(10, '22 Avenue des Champs', '75008', '0612345678', 'sophie.champs@example.com', 'Sophie Champs'),
(11, '7 Boulevard des Acacias', '75012', '0623456789', 'louis.acacias@example.com', 'Louis Acacias'),
(12, '19 Rue des Fleurs', '69002', '0634567890', 'jeanne.fleurs@example.com', 'Jeanne Fleurs');

-- Ajout de nouveaux particuliers
INSERT INTO Particuliers (id, civilitee, prenom) VALUES
(9, 'H', 'Paul'),
(10, 'F', 'Sophie'),
(11, 'H', 'Louis'),
(12, 'F', 'Jeanne');

-- Ajout de nouveaux contrats pour les nouveaux clients
INSERT INTO Contrats (reference, id, client) VALUES
('C010', 2, 9),  -- Paul Mont
('C011', 3, 10), -- Sophie Champs
('C012', 1, 11), -- Louis Acacias
('C013', 2, 12);

INSERT INTO Designations (id, libelle, prix, description) VALUES
(11, 'Ordinateur de bureau', 499.99, 'PC de bureau avec écran et clavier'),
(12, 'Webcam HD', 59.99, 'Webcam haute définition pour vidéoconférences');

-- Ajout de nouveaux services (services spécifiques)
INSERT INTO Services (id, duree) VALUES
(3, 1), -- Service 1h
(4, 2); -- Service 2h

-- Ajout de nouveaux enregistrements dans `ServicesClients` pour lier les contrats et produits
INSERT INTO ServicesClients (id, reference, quantité, prix) VALUES
(2, 'C010', 1, 499.99), -- Paul Mont achète un ordinateur de bureau
(3, 'C011', 2, 59.99), -- Sophie Champs achète 2 webcams
(4, 'C012', 1, 499.99), -- Louis Acacias achète un ordinateur de bureau
(5, 'C013', 1, 59.99), -- Jeanne Fleurs achète une webcam
(6, 'C010', 1, 59.99); -- Paul Mont achète aussi une webcam

-- Ajout de nouvelles sociétés
INSERT INTO Societes (id, siret) VALUES
(2, '12345678901234'), -- Nouvelle société 1
(4, '56789012345678'); -- Nouvelle société 2

-- Ajout de nouveaux statuts pour les contrats
INSERT INTO StatutsContrats (reference, etat, dateAction) VALUES
('C010', 5, '2024-05-10'), -- Contrat signé pour Paul Mont
('C011', 5, '2024-05-12'), -- Contrat envoyé pour Sophie Champs
('C012', 5, '2024-06-15'), -- Contrat payé pour Louis Acacias
('C013', 5, '2024-06-20'); -- Contrat devis pour Jeanne Fleurs
</sql><sql name="SQL 3*">DROP TABLE Clients_Old;
</sql><current_tab id="0"/></tab_sql></sqlb_project>
